private["_aa","_ab","_ac","_ad","_ae","_af","_ag","_ah","_ai","_aj","_ak","_al","_am"];if !(EPOCH_WeatherStaticForecast isEqualTo[])then{_af=EPOCH_WeatherStaticForecast select 0;_ag=EPOCH_WeatherStaticForecast select 1;_ah=EPOCH_WeatherStaticForecast select 2;_ai=EPOCH_WeatherStaticForecast select 3;_aj=EPOCH_WeatherStaticForecast select 4;diag_log format["DEBUG: static weather: %1",EPOCH_WeatherStaticForecast];}else{_al=["Weather",(call EPOCH_fn_InstanceID)]call EPOCH_server_hiveGETRANGE;if((_al select 0)==1 && typeName(_al select 1)=="ARRAY" && !((_al select 1)isEqualTo[]))then{_ak=_al select 1;_af=_ak select 0;_ag=_ak select 1;_ah=_ak select 2;_ai=_ak select 3;_aj=_ak select 4;diag_log format["DEBUG: hive weather: %1",_ak];};};_am=if(sunOrMoon < 1)then{(random 35)+15}else{(random 75)+50};EPOCH_CURRENT_WEATHER=if(isNil "_af")then{_am}else{_af};publicVariable "EPOCH_CURRENT_WEATHER";_ab=if(isNil "_ah")then{[random 0.2,random 0.2,random 20]}else{_ah};_aa=if(isNil "_ag")then{random 1}else{_ag};_ac=if(isNil "_ai")then{random 1}else{_ai};EPOCH_WeatherChangeTime setFog _ab;EPOCH_WeatherChangeTime setOvercast _ac;EPOCH_WeatherChangeTime setRain _aa;_ad=random 10-5;_ae=random 10-5;if(_aa > 0.5)then{_ad=random 20-10;_ae=random 20-10;};if !(isNil "_aj")then{_ad=_aj select 0;_ae=_aj select 1;};setWind[_ad,_ae,true];if(_this)then{forceWeatherChange;};diag_log format["Weather Change: fog: %1 rain: %2 overcast: %3 windx: %4 windz: %5 forced: %6",_ab,_ac,_aa,_ad,_ae,_this];